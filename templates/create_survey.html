<!-- templates/create_survey.html -->
{% extends 'base.html' %}
{% load static %}
{% block content %}
{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}
<form method="POST" enctype="multipart/form-data" id="form">
  {% csrf_token %}
  {{ form.as_p }}
  <div>
    <table class="table">
      {{ questions.as_p }}
    <table class="ts">
      <thead>
        <tr>
          <th class="ts-70gx">Question</th>
          <th class="ts-zv4m">Question Type</th>
          <th class="ts-zv4m">Weighting</th>
          <th class="ts-zv4m">Evaluation Type</th>
          <th class="ts-zv4m"></th>
        </tr>
      </thead>

      <tbody>
        {% for q in questions %}
          {% if q.evaluation_type == 'S' %}
            <tr>
              <td class=" tdh">{{q.prompt}}</td>
              <td class="ts-0lax tdh">{{q.question_type}}</td>

              {% if q.question_type == 'C' %}
                <td class="ts-0lax tdh">N/A</td>
              {% else %}
                <td class="ts-0lax tdh">{{q.weighting}}</td>
              {% endif %}
              <td class="ts-0lax tdh">{{q.evaluation_type}}</td>

              <td class="ts-0lax tdh">
                <a class="btn btn-sm btn-primary" href="{% url 'update_question' survey_id=survey.id question_id=q.id %}">Edit</a>
                <a class="btn btn-sm btn-danger" href="{% url 'delete_question' survey_id=survey.id question_id=q.id %}">Remove</a>
              </td>
            </tr>
          {% endif %}
        {% endfor %}

        {% for q in questions %}
          {% if q.evaluation_type == 'P' %}
            <tr>
              <td class=" tdh">{{q.prompt}}</td>
              <td class="ts-0lax tdh">{{q.question_type}}</td>

              {% if q.question_type == 'C' %}
                <td class="ts-0lax tdh">N/A</td>
              {% else %}
                <td class="ts-0lax tdh">{{q.weighting}}</td>
              {% endif %}
              <td class="ts-0lax tdh">{{q.evaluation_type}}</td>

              <td class="ts-0lax tdh">
                <!--
                <a class="btn btn-sm btn-primary" href="{% url 'update_question' survey_id=survey.id question_id=q.id %}">Edit</a>
                <a class="btn btn-sm btn-danger" href="{% url 'delete_question' survey_id=survey.id question_id=q.id %}">Remove</a>
                -->
              </td>
            </tr>
          {% endif %}
        {% endfor %}

      </tbody>
    </table>
  </div>
  <input type="submit" value="Submit">
</form>


    
    
{% endblock %}
{% block extra_js %}
  <script>
    $("#form").dirty({
      preventLeaving: true,
      leavingMessage: "There are unsaved changes on this page which will be discarded if you continue."});
    console.log('Dirty')
  </script>
{% endblock %}